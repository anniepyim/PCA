<html lang="en">
    <head>
        <title>MitoXplorer - Analysis</title>
        <meta charset=utf-8>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="./css/style.css" rel="stylesheet" >
        
        <script src="./js/jquery-1.12.4.min.js"></script>
        <script src="./js/bootstrap.min.js"></script>
        <script src="./js/bootstrap-select.min.js"></script>
        <link rel="icon" type="image/png" href="img/logos/favicon.png">
    </head>
    
    <body>

        <!-- Page Content -->     
        <div class="container-fluid main">
                <div class = "col-md-2" id="sidebar">
                    <div id = "rowtip1" class="row tip" style="margin-top:0px;"></div>
                    <div id = "rowtip2" class="row tip" style="margin-top:0px"></div> 
                </div>
                <div class="col-md-10">
                    <div id = "svgs-all" class="col-md-12">
                    </div>   
                </div>
        </div>
    <script src="./js/PCA.js"></script>
    <script>
        // var json = ["HCT116-21-3-c1","HCT116-21-3-c3","HCT116-5-4","HCT116-8-3-c3","HCT116-8-3-c4","RPE-21-3-c1"],
        //     sessionid = "test",
        //     organism = "Human",
        //     host = "localhost",
        //     port = "3306",
        //     user = "root",
        //     passwd = "",
        //     unix_socket = "/tmp/mysql.sock";

        // var parameter = 'jsons=' + JSON.stringify(json) + '&organism='+ organism +'&sessionid='+ sessionid + '&host='+host + '&port='+port + '&user='+user + '&passwd='+passwd + '&unix_socket='+unix_socket;

        // var pyScript = "./python/PCA_mysql.py";
        
        // var jsonGroupCount = 0;

        var svg = "svgs-all";

        var data_urls = ['./data/All Processes.json','./data/Amino Acid Metabolism.json','./data/Apoptosis.json','./data/Bile Acid Synthesis.json','./data/Calcium Signaling and Transport.json','./data/Electron Transport Chain.json','./data/Fatty Acid Biosynthesis and Elongation.json','./data/Fatty Acid Degradation and Beta-oxidation.json','./data/./data/Fatty Acid Metabolism.json','./data/Fe-S cluster biosynthesis.json','./data/Folate and Pterine Metabolism.json','./data/Glycolysis.json','./data/Heme Biosynthesis.json','./data/Import and Sorting.json','./data/Metabolism of Lipids and Lipoproteins.json','./data/Metabolism of Vitamins and Co-Factors.json','./data/Mitochondrial Carrier.json','./data/Mitochondrial Dynamics.json','./data/Mitochondrial Signaling.json','./data/Nucleotide Metabolism.json','./data/Protein Stability and Degradation.json','./data/Pyruvate Metabolism.json','./data/ROS Defense.json','./data/Replication and Transcription.json','./data/Translation.json','./data/Tricarboxylic Acid Cycle.json','./data/Ubiquinone Biosynthesis.json']
        
        //Add loading gif here
        // var el = document.getElementById( svg );
        // while (el.hasChildNodes()) {el.removeChild(el.firstChild);}
        // var div = document.createElement('div');
        // div.setAttribute("align", "center");
        // div.innerHTML ='<img id="loading" src="./img/loading.gif">';
        // el.appendChild(div);
        
        function onError(res) {
            d3.select('#loading').remove();
            document.getElementById('warning').innerHTML="<font color=\"red\">"+res;
            throw new Error("Something went badly wrong!");
        }

        PCA.init(svg,data_urls,onError);
    </script>
        <!--<script>
            var c = document.getElementById("canvasDownload");

            function downloadImage(){
                var a = document.createElement('a');
                // toDataURL defaults to png, so we need to request a jpeg, then convert for file download.
                a.href = c.toDataURL("image/png");
                a.download = 'somefilename.png';
                //a.click();

                // create a mouse event
                var event = new MouseEvent('click');

                // dispatching it will open a save as dialog in FF
                a.dispatchEvent(event);

            }

            $("#downloadsvg").click(function(){

                sidebarWidth = document.getElementById("sidebar").offsetWidth
                sidebarHeight = document.getElementById("sidebar").offsetHeight

                pcbarchartWidth = document.getElementById("pcbarchart").offsetWidth
                pcbarchartHeight = document.getElementById("pcbarchart").offsetHeight+document.getElementById("pcbcsvg").offsetWidth

                pcacanvas = document.getElementById("pcacanvas")
                pcacanvasWidth = pcacanvas.width
                pcacanvasHeight = pcacanvas.height

                //check the width and height of the canvas element

                canvasWidth = sidebarWidth + pcacanvasWidth + pcbarchartWidth
                canvasHeight = sidebarHeight > pcbarchartHeight ? (sidebarHeight > pcacanvasHeight ? sidebarHeight : pcacanvasHeight) : (pcbarchartHeight > pcacanvasHeight ? pcbarchartHeight : pcacanvasHeight)

                //set the width and height accordingly
                c.width = canvasWidth
                c.height = canvasHeight

                var ctx = c.getContext("2d");
                ctx.fillStyle = "white";
                ctx.fillRect(0, 0, c.width, c.height);

               $("#canvasDownloadPCA").css("display","block")
                html2canvas(document.querySelector("#canvasDownloadPCA")).then(pca => {
                    ctx.drawImage(pca,sidebarWidth,0);
                    $("#canvasDownloadPCA").css("display","none")
                     
                });

                html2canvas(document.querySelector("#sidebar")).then(sidebarImage => {
                    //draw sidebar
                    ctx.drawImage(sidebarImage,0,0);
                });

                html2canvas(document.querySelector("#pcbarchart")).then(pcbctop => {
                    ctx.drawImage(pcbctop,sidebarWidth + pcacanvasWidth,0);
                     
                });

                $("#test2").css("display","block")
                html2canvas(document.querySelector("#test2")).then(pcbc => {
                    ctx.drawImage(pcbc,sidebarWidth + pcacanvasWidth+20,document.getElementById("pcbarchart").offsetHeight);
                    $("#test2").css("display","none")
                    downloadImage()
                     
                });

            })

        </script>-->
    </body>
</html>
